import{createPortal as t}from"react-dom";import{createContext as e,memo as i,useState as r,useCallback as o,useRef as n,useEffect as s,useContext as a}from"react";import c from"@emotion/styled/base";import m from"@mui/material/Stack";import l from"@mui/material/Alert";import{jsx as g}from"@emotion/react";import{Slide as u}from"@mui/material";function p(){return p=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var i=arguments[e];for(var r in i)Object.prototype.hasOwnProperty.call(i,r)&&(t[r]=i[r])}return t},p.apply(this,arguments)}const I=e();I.Consumer,I.Provider;var d=i((t=>{const{message:e,options:i={},id:a,isEntered:c,notifyItemProps:m}=t,{defaultSeverity:u,TransitionComponent:I,TransitionProps:d,AlertProps:C,generalTimeOut:A,remove:b,customAlert:X}=m,{timeOut:G=A,isPersist:y}=i,[f,v]=r(!0),h=function(){const t=n(!1);return s((()=>(t.current=!0,()=>{t.current=!1})),[]),o((()=>t.current),[])}();let B=n(null);s((()=>(clearTimeout(B.current),B.current=setTimeout((()=>{h&&!y&&v(!1)}),G),()=>clearTimeout(B.current))),[G,y,h]),s((()=>{c||v(!1)}),[c,a]);return g(I,p({in:f,mountOnEnter:!0,unmountOnExit:!0,onExited:()=>{!f&&b&&b(a)}},d),X?g("div",{className:"Custom-Alert"},X(t)):g(l,p({id:a,severity:i&&i.variant||u},C),e+a))}));const C=c("div","production"===process.env.NODE_ENV?{target:"e3eaemj0"}:{target:"e3eaemj0",label:"NotifyWrapperStyled"})("position:fixed;z-index:100000;height:auto;max-width:50%;",(({position:t})=>t.split("-").map((t=>`${t}: 10px`))),";"+("production"===process.env.NODE_ENV?"":"/*# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIm5vdGlmeVdyYXBwZXIuanMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBSXNDIiwiZmlsZSI6Im5vdGlmeVdyYXBwZXIuanMiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgc3R5bGVkIGZyb20gXCJAZW1vdGlvbi9zdHlsZWRcIjtcbmltcG9ydCBTdGFjayBmcm9tIFwiQG11aS9tYXRlcmlhbC9TdGFja1wiO1xuaW1wb3J0IE5vdGlmeUl0ZW0gZnJvbSBcIi4vbm90aWZ5SXRlbVwiO1xuXG5jb25zdCBOb3RpZnlXcmFwcGVyU3R5bGVkID0gc3R5bGVkLmRpdmBcbiAgcG9zaXRpb246IGZpeGVkO1xuICB6LWluZGV4OiAxMDAwMDA7XG4gIGhlaWdodDogYXV0bztcbiAgbWF4LXdpZHRoOiA1MCU7XG5cbiAgJHsoeyBwb3NpdGlvbiB9KSA9PlxuICAgIHBvc2l0aW9uLnNwbGl0KFwiLVwiKS5tYXAoKGl0ZW0pID0+IHtcbiAgICAgIHJldHVybiBgJHtpdGVtfTogMTBweGA7XG4gICAgfSl9XG5gO1xuXG5jb25zdCBOb3RpZnlXcmFwcGVyID0gKHsgbm90aWZ5TGlzdCwgcmVtb3ZlLCAuLi5yZXN0UHJvcHMgfSkgPT4ge1xuICBjb25zdCB7XG4gICAgcG9zaXRpb24sXG4gICAgZGVmYXVsdFNldmVyaXR5LFxuICAgIGdlbmVyYWxUaW1lT3V0LFxuICAgIFRyYW5zaXRpb25Db21wb25lbnQsXG4gICAgVHJhbnNpdGlvblByb3BzLFxuICAgIEFsZXJ0UHJvcHMsXG4gICAgU3RhY2tQcm9wcyxcbiAgICBjdXN0b21BbGVydCxcbiAgfSA9IHJlc3RQcm9wcztcblxuICBjb25zdCBub3RpZnlJdGVtUHJvcHMgPSB7XG4gICAgZGVmYXVsdFNldmVyaXR5LFxuICAgIFRyYW5zaXRpb25Db21wb25lbnQsXG4gICAgVHJhbnNpdGlvblByb3BzLFxuICAgIEFsZXJ0UHJvcHMsXG4gICAgZ2VuZXJhbFRpbWVPdXQsXG4gICAgcmVtb3ZlLFxuICAgIGN1c3RvbUFsZXJ0LFxuICB9O1xuXG4gIHJldHVybiAoXG4gICAgPE5vdGlmeVdyYXBwZXJTdHlsZWQgcG9zaXRpb249e3Bvc2l0aW9ufT5cbiAgICAgIDxTdGFjayBzcGFjaW5nPXsyfSB7Li4uU3RhY2tQcm9wc30+XG4gICAgICAgIHtub3RpZnlMaXN0Lm1hcCgoaXRlbSkgPT4ge1xuICAgICAgICAgIHJldHVybiAoXG4gICAgICAgICAgICA8Tm90aWZ5SXRlbVxuICAgICAgICAgICAgICBrZXk9e2l0ZW0uaWR9XG4gICAgICAgICAgICAgIG5vdGlmeUl0ZW1Qcm9wcz17bm90aWZ5SXRlbVByb3BzfVxuICAgICAgICAgICAgICB7Li4uaXRlbX1cbiAgICAgICAgICAgIC8+XG4gICAgICAgICAgKTtcbiAgICAgICAgfSl9XG4gICAgICA8L1N0YWNrPlxuICAgIDwvTm90aWZ5V3JhcHBlclN0eWxlZD5cbiAgKTtcbn07XG5cbmV4cG9ydCBkZWZhdWx0IE5vdGlmeVdyYXBwZXI7XG4iXX0= */")),A=({notifyList:t,remove:e,...i})=>{const{position:r,defaultSeverity:o,generalTimeOut:n,TransitionComponent:s,TransitionProps:a,AlertProps:c,StackProps:l,customAlert:u}=i,I={defaultSeverity:o,TransitionComponent:s,TransitionProps:a,AlertProps:c,generalTimeOut:n,remove:e,customAlert:u};return g(C,{position:r},g(m,p({spacing:2},l),t.map((t=>g(d,p({key:t.id,notifyItemProps:I},t))))))};class b extends React.PureComponent{constructor(t){super(t);const{wrapperElement:e,wrapperName:i}=this.props,r=document.createElement(e||"div");r.className=i||"rezvani-notify-wrapper",document.body.appendChild(r),this.renderPortal=r,this.actionQueue=[],this.isStateBlocked=!1,this.state={notifyList:[]}}getList=()=>[...this.state.notifyList];commitState=(t,e)=>{this.isStateBlocked=e,this.setState({notifyList:t},(()=>{e||this.proccessQueue()}))};proccessQueue=()=>{const t=this.actionQueue.shift();t&&t()};notifier=(t,e)=>{const{maxNotif:i,preventDuplicate:r}=this.props,o=Math.random().toString(16).slice(2),n={message:t,options:e,isEntered:!0,id:o},s=this.getList();if(!(s.findIndex((e=>e.message===t))>=0&&r)){if(!this.isStateBlocked)return s.length>=i?(s[0].isEntered=!1,s.push(n),this.commitState(s,!0)):(s.push(n),this.commitState(s,!1)),o;this.actionQueue.push((()=>this.notifier(t,e)))}};removeNofityById=t=>{const e=[...this.state.notifyList].filter((e=>e.id!==t));this.commitState(e,!1)};removeNotifierAnimationById=t=>{const e=this.getList(),i=e.findIndex((e=>e.id===t));i>=0&&(e[i].isEntered=!1),this.commitState(e,!1)};render(){const{notifyList:e}=this.state,{children:i,...r}=this.props;return g(I.Provider,{value:{notifier:this.notifier,removeNotifier:this.removeNotifierAnimationById}},i,t(g(A,p({notifyList:e,remove:this.removeNofityById},r)),this.renderPortal))}}b.defaultProps={customAlert:null,preventDuplicate:!1,position:"bottom-left",wrapperElement:"div",wrapperName:"rezvani-notify-wrapper",maxNotif:3,defaultSeverity:"info",generalTimeOut:3e3,TransitionComponent:u,TransitionProps:{},AlertProps:{},StackProps:{spacing:1,direction:"column-reverse"}};const X=()=>a(I),G=t=>{class e extends React.PureComponent{render(){return g(I.Consumer,null,(e=>g(t,p({},this.props,e))))}}return e};export{b as MuiNotifyProvider,X as useNotifier,G as withNotifier};
