"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e=require("react-dom"),t=require("react"),i=require("@emotion/styled"),r=require("@mui/material/Stack"),o=require("@mui/material/Alert"),n=require("@mui/material");function s(e){return e&&"object"==typeof e&&"default"in e?e:{default:e}}var a=s(i),c=s(r),u=s(o);function m(){return m=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var i=arguments[t];for(var r in i)Object.prototype.hasOwnProperty.call(i,r)&&(e[r]=i[r])}return e},m.apply(this,arguments)}const l=t.createContext();l.Consumer,l.Provider;const p=e=>{const{message:i,options:r={},id:o,isEntered:n,notifyItemProps:s}=e,{defaultSeverity:a,TransitionComponent:c,TransitionProps:l,AlertProps:p,generalTimeOut:d,remove:f,customAlert:h}=s,{timeOut:v=d,isPersist:y}=r,[P,E]=t.useState(!0),S=function(){const e=t.useRef(!1);return t.useEffect((()=>(e.current=!0,()=>{e.current=!1})),[]),t.useCallback((()=>e.current),[])}();let x=t.useRef(null);t.useEffect((()=>(clearTimeout(x.current),x.current=setTimeout((()=>{S&&!y&&E(!1)}),v),()=>clearTimeout(x.current))),[v,y,S]),t.useEffect((()=>{n||E(!1)}),[n,o]);return React.createElement(c,m({in:P,mountOnEnter:!0,unmountOnExit:!0,onExited:()=>{!P&&f&&f(o)}},l),h?React.createElement("div",{className:"Custom-Alert"},h(e)):React.createElement(u.default,m({id:o,severity:r&&r.variant||a},p),i+o))};var d=t.memo(p);const f=a.default.div`
  position: fixed;
  z-index: 100000;
  height: auto;
  max-width: 50%;

  ${({position:e})=>e.split("-").map((e=>`${e}: 10px`))}
`,h=({notifyList:e,remove:t,...i})=>{const{position:r,defaultSeverity:o,generalTimeOut:n,TransitionComponent:s,TransitionProps:a,AlertProps:u,StackProps:l,customAlert:p}=i,h={defaultSeverity:o,TransitionComponent:s,TransitionProps:a,AlertProps:u,generalTimeOut:n,remove:t,customAlert:p};return React.createElement(f,{position:r},React.createElement(c.default,m({spacing:2},l),e.map((e=>React.createElement(d,m({key:e.id,notifyItemProps:h},e))))))};class v extends React.PureComponent{constructor(e){super(e);const{wrapperElement:t,wrapperName:i}=this.props,r=document.createElement(t||"div");r.className=i||"rezvani-notify-wrapper",document.body.appendChild(r),this.renderPortal=r,this.actionQueue=[],this.isStateBlocked=!1,this.state={notifyList:[]}}getList=()=>[...this.state.notifyList];commitState=(e,t)=>{this.isStateBlocked=t,this.setState({notifyList:e},(()=>{t||this.proccessQueue()}))};proccessQueue=()=>{const e=this.actionQueue.shift();e&&e()};notifier=(e,t)=>{const{maxNotif:i,preventDuplicate:r}=this.props,o=Math.random().toString(16).slice(2),n={message:e,options:t,isEntered:!0,id:o},s=this.getList();if(!(s.findIndex((t=>t.message===e))>=0&&r)){if(!this.isStateBlocked)return s.length>=i?(s[0].isEntered=!1,s.push(n),this.commitState(s,!0)):(s.push(n),this.commitState(s,!1)),o;this.actionQueue.push((()=>this.notifier(e,t)))}};removeNofityById=e=>{const t=[...this.state.notifyList].filter((t=>t.id!==e));this.commitState(t,!1)};removeNotifierAnimationById=e=>{const t=this.getList(),i=t.findIndex((t=>t.id===e));i>=0&&(t[i].isEntered=!1),this.commitState(t,!1)};render(){const{notifyList:t}=this.state,{children:i,...r}=this.props;return React.createElement(l.Provider,{value:{notifier:this.notifier,removeNotifier:this.removeNotifierAnimationById}},i,e.createPortal(React.createElement(h,m({notifyList:t,remove:this.removeNofityById},r)),this.renderPortal))}}v.defaultProps={customAlert:null,preventDuplicate:!1,position:"bottom-left",wrapperElement:"div",wrapperName:"rezvani-notify-wrapper",maxNotif:3,defaultSeverity:"info",generalTimeOut:3e3,TransitionComponent:n.Slide,TransitionProps:{},AlertProps:{},StackProps:{spacing:1,direction:"column-reverse"}};exports.MuiNotifyProvider=v,exports.useNotifier=()=>t.useContext(l),exports.withNotifier=e=>{class t extends React.PureComponent{render(){return React.createElement(l.Consumer,null,(t=>React.createElement(e,m({},this.props,t))))}}return t};
